# 리액트 렌더트리와 DOM트리 구조의 차이

리액트 렌더 트리와 DOM 트리는 웹 애플리케이션에서 UI를 구성하는 중요한 구조적 요소로, 이 두 구조는 각각 다른 목적과 방식으로 작동하며, 리액트 앱의 성능과 최적화에 중요한 역할을 한다.

<br />

## 리액트 렌더 트리

리액트 렌더 트리는 가상 DOM(Virtual DOM)이라고 불리며, 리액트 애플리케이션의 컴포넌트 구조를 메모리에 표현한 것이다. 이 트리는 실제 DOM에 반영되기 전에 리액트 엘리먼트와 컴포넌트의 계층적 구조를 나타낸다.

리액트 렌더 트리는 리액트 컴포넌트로 구성되었으며, 각 컴포넌트는 해당 컴포넌트의 상태와 프로퍼티를 기반으로 렌더링 되는 결과를 포함한다. 렌더 트리는 컴포넌트의 렌더링 결과를 추적하고, 상태 변화가 발생했을 때 필요한 최소한의 DOM 업데이트를 계산하는 데 사용된다.
리액트의 가상 DOM은 실제 DOM 변경을 최소화하여 성능을 최적화하고, 렌더링 프로세스를 효율적으로 관리하기 위해 설계 됐다.

가상 DOM은 실제 DOM의 구조와 비슷한, React 객체의 트리로, 개발자는 직접 DOM을 수정하지 않고 가상 DOM을 제어하면 React에서 적절하게 가상 DOM을 DOM에 반영하는 작업을 한다. 가상 DOM 의 장점 중 하나는 직접 DOM을 조작하지 않아도 된다는 점이다. 웹은 점점 더 복잡해져 가는데 수백, 수천개의 DOM을 직접 관리, 조작하는 과정은 복잡하고, 실수가 발생할 가능성도 높아지게 되는데, 가상 DOM은 이러한 복잡한 과정들을 자동화, 추상화해 준다는 장점이 있다.

다른 장점은 DOM 의 update를 Batch로 처리로 실제 DOM의 리렌더링 연산을 최소화 할 수 있다는 점이다. 즉, 연쇄적으로 Reflow, Repaint가 발생하는 것을 줄이고, 필요한 연산을 한번에 묶어서 처리하게 전달하게 된다.

React는 특정 부분이 리렌더링 되어야 할 때 그 부분에 해당하는

1. Virtual DOM 트리를 메모리에 새로 생성한다.
2. 그리고 이전 Virtual DOM 트리와 O(n)의 휴리스틱 알고리즘으로 비교하여 차이점을 파악한다.
3. 그리고 그 차이점들을 하나로 모아서 실제 DOM에 전달한다.

이로 인해 실제 DOM의 리렌더링 연산은 단 한 번만 일어나게 되어, 큰 성능의 이득을 얻게 된다.

> 💡 휴리스틱 검증이란? <br /><br />
> 휴리스틱 검증은 문제를 빠르고 효율적으로 해결하기 위해 설계된 근사적 방법론으로, 완벽하게 최적화된 솔루션을 보장하지는 않지만, 상대적으로 낮은 계산 비용으로 좋은 솔루션을 빠르게 제공한다. 리액트에서 사용되는 휴리스틱 검증은 주로 Virtual DOM과 실제 DOM 사이의 차이를 효과적으로 비교하고 업데이트를 결정하는 데 적용되는데 아래와 같은 역할을 한다.
>
> - 비교 효율성: Virtual DOM 트리 간의 비교를 통해 실제 DOM에 반영해야 할 최소한의 변경 사항을 파악한다. 이 비교 과정은 O(n) 시간 복잡도로 수행되는데, 여기서 n은 처리해야 할 노드의 수를 의미한다. O(n)은 모든 노드를 한 번씩만 검사하므로, 대규모 업데이트에서도 비교적 효율적이다.
> - 업데이트 최적화: 차이점을 분석한 후, 리액트는 실제 DOM을 업데이트할 때 필요한 부분만을 선택적으로 업데이트한다. 이로 인해 불필요한 DOM 조작을 줄이고 성능을 향상시킬 수 있다.
> - 효과적인 렌더링 결정: 휴리스틱 검증은 컴포넌트의 특정 변경 사항이 뷰에 미치는 영향을 계산하여, 실제로 필요한 렌더링 작업만을 수행하도록 한다. 이는 특히 복잡한 애플리케이션에서 성능 저하를 방지하는 데 중요하다.

<br />

## DOM 트리

> 💡 DOM이란? <br /><br />
> 브라우저는 문자열 형식의 HTML을 곧바로 이해할 수 없기 때문에, 브라우저가 이해하고 활용할 수 있는 구조로의 변환이 필요하다.<br />
> DOM(Document Object Model)은 브라우저 렌더링 엔진의 HTML parser에 의해 생성된 '트리' 구조의 Node 객체 모델로, DOM의 목적은 JS를 사용하여 문서에 대한 추가, 삭제, 이벤트 처리 등을 처리하는 인터페이스를 제공하는 것이다.

<p align="center">
  <img width="800" alt="rendering process of the browser" src="https://github.com/team-Palindrome/React-Study/assets/138760807/6f277314-15ec-4bd3-82f5-6dd2ff08f11e">
</p>

> 💡 브라우저 렌더링 과정은 어떻게 될까? <br /><br />
> 브라우저의 렌더링 과정은 먼저 DOM 트리를 생성하고 CSS parser가 inline style과 CSS 코드를 파싱 하여 CSSOM 트리을 생성한다.<br />
> 그후 DOM과 CSSOM의 정보를 바탕으로, 실제로 브라우저의 화면에 노출되어야 하는 노드들에 대한 정보인 렌더 트리 생성하는데 이때 실제로 브라우저의 화면에 노출된다는 것은 display: none 인 보이지 않는 노드들은 렌더 트리를 생성할 때 제외한다는 것을 의미하고 반면, 공간을 차지하는 visibility: hidden 속성은 렌더 트리에 포함된다.<br />
> 그 다음은 렌더 트리의 각 노드들이 브라우저의 뷰포트(Viewport) 내에서 어느 위치에 어떤 크기로 배치되어야 하는지에 대한 정보를 계산하고 렌더 트리의 각 노드들을 모니터에 실제 픽셀로 그린다.

DOM 트리는 HTML 문서의 요소를 객체로 표현한 구조로, 웹 페이지를 구성하는 모든 요소를 노드로 가지고 있다. 브라우저는 이트리를 사용하여 페이지를 렌더링하고 사용자와의 상호작용을 처리한다.

DOM트리는 HTML 문서의 태그마다 하나의 노드를 가지며, 요소의 계층적 관계를 반영하는데, 이때 각 노드는 속성, 이벤트 리스터, 자식 노드 등의 정보를 포함하고 있다.<br />
브라우저는 DOM 트리를 통해 요소의 스타일을 계산하고, 페이지 레이아웃을 결정하며, 최종적으로 사용자에게 보여질 페이지를 렌더링한다. DOM은 웹페이지의 구조를 브라우저가 이해하고 조작할 수 있는 형식으로 제공하여, 동적인 경험을 가능하게한다.

<br />

## 리액트 렌더 트리와 DOM트리의 차이

리액트 렌더 트리와 DOM 트리의 주요 차이점은 업데이트 메커니즘과 성능 최적화 방식에 있다. 리액트는 렌더 트리를 활용하여 컴포넌트의 상태 변화를 추적하고 필요한 최소한의 DOM 업데이트를 계산하여 불필요한 DOM 조작을 줄이고 성능을 최적화한다. 반면에, DOM 트리는 직접적인 HTML 요소의 변경이나 JavaScript의 조작에 의해 동적으로 업데이트되며, 이러한 조작은 때때로 성능 저하를 일으킬 수 있다. 따라서, 리액트 렌더 트리는 주로 UI의 동적인 상태 관리와 효율적인 업데이트를 목적으로 사용되는 반면, DOM 트리는 웹 페이지의 구조적 표현과 상호작용을 관리하는 데 주로 사용된다.

<p align="center">
  <img width="800" alt="treeImage" src="https://github.com/team-Palindrome/React-Study/assets/138760807/249bb9ce-65e9-4498-b948-8961249e590e">
</p>

이러한 차이점들은 리액트가 효율적인 사용자 인터페이스 구축을 위해 DOM과 다르게 어떻게 접근하는지를 보여주는데, 리액트의 가상 DOM 기술은 현대 웹 개발에서 중요한 이점을 제공하며, 성능과 사용자 경험을 향상시키는 핵심 요소로 자리 잡고 있다.
